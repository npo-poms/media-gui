<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>POMS GTAA</title>
    <script type="application/javascript">
      var gtaa = {

        open: function (callback, options, domain) {

            var popup;
            var iframe;
            var query = '';

            if (options) {
                for (var i in options) {
                    var jwsString = options[i];
                    if (jwsString !== '') {
                        query += (query.length ? '&' : '?') + i + '=' + jwsString;
                    }
                }
            }

            function handleMessage(e) {
                if (e.origin === domain) {
                    callback(e.data);
                    close();
                }
            }

            // Create IE + others compatible event handler
            var eventMethod = window.addEventListener ? "addEventListener" : "attachEvent";
            var eventer = window[eventMethod];
            var messageEvent = eventMethod === "attachEvent" ? "onmessage" : "message";

            // Listen to message from child window
            eventer(messageEvent, function (e) {
                console && console.log("message received ",  e.data);
                if (typeof e.data === 'object') {
                    callback(e.data);
                    close();
                } else if (e.data === "Canceled") {
                    close();
                }
            }, false);

            if (document.all) {
                // some hackery to help IE, because in IE you may not post to other window, only from an iframe.
                iframe = document.createElement('iframe');
                iframe.setAttribute('style', 'position:absolute;display:none');
                iframe = document.body.appendChild(iframe);
                iframe.src = domain + '/thesaurus/IE.html' + query;
            } else {
                popup = window.open(domain + '/thesaurus/example/popup/' + query, '', 'width=1024,height=800,titlebar=no,toolbar=no,statusbar=no,directories=no,location=no');
            }

            function close(){
                if (popup) {
                    popup.close();
                }
                if (iframe) {
                    iframe.parentNode.removeChild(iframe);
                }
            }

        }
    };
    </script>
    <script type="application/javascript" src="http://code.jquery.com/jquery-3.3.1.min.js"></script>
    <link href="/v1/css/poms-5.7.0.css" rel="stylesheet" />
    <style type="text/css">
            body {
                padding: 20px;
            }

            a {
                text-decoration: underline;
            }

            .row {
                padding-top: 1em;
            }

            .poms-form .hide {
                display: none;
            }

            .poms-form .show {
                display: block;
            }
        </style>
    <script type="application/javascript">


            function showConcept() {
                $("#person").removeClass("show");
                $("#person").addClass("hide");

                $("#concept").removeClass("hide");
                $("#concept").addClass("show");
            }

            $(document).ready(function () {
                $("#open").click(function (event) {
                    event.preventDefault();
                    gtaa.open(
                        function (concept) {
                            if (typeof concept === 'object') {
                                showConcept();
                                $('#value').val(concept.value);
                                $('#id').val(concept.id);
                            }
                            $('#json').val(JSON.stringify(concept));
                        }, {
                            value: $('#value').val(),
                            id: $('#id').val(),
                            origin: $('#origin').val(),
                            axes: 'GeografischeNamen',
                            updateService: "https://rs-dev.poms.omroep.nl",
                            jwt: 'eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJHVEFBUGVyc29uIiwidXNyIjoiZy52aW5jaUB2cHJvLm5sIiwiaWF0IjoxNTYxMzgyNjk4LCJpc3MiOiJleGFtcGxlIiwiZXhwIjoxNTYxMzgzNTk4fQ.9FlKgwk8sNCi2kHHHpWFbnXlqu240yU45lidC8-mOFU'
                        }, 'https://rs-dev.poms.omroep.nl/v1'
                    );
                });
            });
        </script>
</head>
<body>
<div class="poms-form">
    <div class="form-fields">
        <div class="col-8">
            <div class="row">
                <h1>GTAA - Concept example</h1>
                <span>
                        Binnen de GTAA thesaurus is het mogelijk om op verschillende assen naar naar termen te zoeken.
                        De mogelijke termen zijn te vinden op
                        <a href="http://openskos.org/api/collections/beg:gtaa.html">gtaa conceptSchemes</a>
                        lijst.
                        <br /><br />
                    </span>
                <p>
                    Fill in the below form if you want (they are all optional) and press 'Open'.
                </p>
            </div>
            <form>
                <div class="row concept" id="concept">
                    <div class="col-6">
                        <label for="value">Value:</label><input id="value" type="text" />
                    </div>
                </div>
                <div class="row">
                    <div class="col-6">
                        <label for="id">GTAA ID ( full GTAA uri ):</label>
                        <input id="id" type="text" /></div>
                </div>
                <div class="row">
                    <button class="btn-rect" id="open">Open</button>
                    <button type="reset" class="btn-rect" id="reset">Clear</button>
                </div>
                <div class="row">
                    <label for="json">Result:</label>
                    <textarea id="json"></textarea>
                </div>
            </form>
        </div>
    </div>
</div>
</body>
</html>