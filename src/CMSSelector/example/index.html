<!doctype html>
<html lang="en">
  <head>
    <title>POMS Media selector</title>
    <script src="../media2.js"></script>
    <link rel="stylesheet" href="../../css/poms-{version}.css"/>
    <style>
      body {
        padding: 20px;
      }

      #type {
        height: 100px;
      }

      .poms-form.example select {
        appearance: menulist-button;
      }
      .poms-form.example label {
        margin-bottom: 10px;
      }
      
      #select {
        margin: 8px 0 20px;
      }

      a {
        text-decoration: underline;
      }

    </style>
  </head>
  <body>

    <div class="poms-form example">
      <div class="form-fields">

        <div class="col-8">

          <div class="row">
            <h1>CMSSelector - example</h1>
            <p>
              Check out the <a href="https://wiki.vpro.nl/display/poms/CMS+integration">wiki</a> page for usage
              information.
              <br/><br/>
            </p>
          </div>

          <div class="row">
            <div class="col-6">
              <label for="type">Media type filter:</label>
              <select id="type" multiple="multiple">
              </select>
              
              <label for="properties.writable">Writable:</label>
              <input type="checkbox" id="properties.writable" />
              
              <label for="avType">AVType:</label>
              <select id="avType">
                <option value="">ANY</option>
                <option value="AUDIO">Audio</option>
                <option value="VIDEO">Video</option>
              </select>
              
            </div>
            <div class="col-6">
              <label for="return">Return data:</label>
              <select id="return">
                <option value="">MID (default)</option>
                <option value="mid">MID</option>
                <option value="title">Title</option>
                <option value="data">All (JSON) data</option>
              </select>
            </div>
          </div>

          <div class="row">
            <button id="select" class="btn-rect">Select</button>
          </div>

          <div class="row">
            <label for="result">Result:</label>
            <input id="result" type="text"/>
            <label for="value">Raw result</label>
            <textarea id="value"> </textarea>
          </div>

        </div>

      </div>
    </div>


    <script>
      const mediaTypes = [
        {"id": "MEDIA", "text": "Alle media"}, 
        {"id": "PROGRAM", "text": "Programma"}, 
        {"id": "BROADCAST", "text": "Uitzending"}, 
        {"id": "CLIP", "text": "Clip"}, 
        {"id": "STRAND", "text": "Koepelprogramma"},
        {"id": "TRAILER", "text": "Trailer"}, 
        {"id": "MOVIE", "text": "Film"}, 
        {"id": "GROUP", "text": "Groep"}, 
        {"id": "SERIES", "text": "Serie"}, 
        {"id": "SEASON", "text": "Seizoen"}, 
        {"id": "UMBRELLA", "text": "Paraplu"}, 
        {"id": "ARCHIVE", "text": "Archief"},
        {"id": "COLLECTION", "text": "Collectie"}, 
        {"id": "PLAYLIST", "text": "Speellijst"},
        {"id": "ALBUM", "text": "Album"},
        {"id": "SEGMENT", "text": "Segment"}, 
        {"id": "TRACK", "text": "Track"}, 
        {"id": "VISUALRADIO", "text": "Visual radio"}, 
        {"id": "RECORDING", "text": "Opname"}, 
        {"id": "PROMO", "text": "Promo"}
      ];
      const mediaTypeSelector = document.getElementById('type');

      mediaTypes.forEach(function (mediaType) {
        const option = document.createElement('option');
        option.value = mediaType.id;
        option.innerHTML = mediaType.text;

        mediaTypeSelector.appendChild(option);
      });
      
      document.getElementById('select').onclick = function () {
        const multipleType = document.getElementById('type');
        const types = [];
        for (let i = 0; i < multipleType.options.length; i++) {
          if (multipleType.options[i].selected) {
            types.push(multipleType.options[i].value);
          }
        }
        nl_vpro_media_CMSSelector.select(
                function (value) {
                  let result = value;
                  if (typeof result === "object") {
                    result = result.mid + ":" + result.title;
                  }
                  document.getElementById('result').value = result;
                  document.getElementById('value').value = JSON.stringify(value);

                }, {
                  mediaType: types.join(),
                  "properties.writable": document.getElementById('properties.writable').checked,
                  avType: document.getElementById('avType').value,
                  returnValue: document.getElementById('return').value
                }
        );
      };
    </script>

  </body>
</html>
