<!doctype html>
<html lang="en">
  <head>
    <title>POMS Media selector</title>
    <script src="../media2.js"></script>
    <link rel="stylesheet" href="../../css/poms-{version}.css"/>
    <style>
      body {
        padding: 20px;
      }

      #type {
        height: 100px;
      }

      .poms-form.example select {
        appearance: menulist-button;
      }
      .poms-form.example label {
        margin-bottom: 10px;
      }

      #select {
        margin: 8px 0 20px;
      }

      a {
        text-decoration: underline;
      }

    </style>
  </head>
  <body>

    <div class="poms-form example">
      <div class="form-fields">

        <div class="col-8">

          <div class="row">
            <h1>CMSSelector - example</h1>
            <p>
              Check out the <a href="https://publiekeomroep.atlassian.net/wiki/spaces/POMSA/pages/3904177007/CMS+integration">wiki</a> page for usage
              information.
            </p>
            <p>
              You might also want to check the source of this page.
            </p>
          </div>

          <div class="row">
            <div class="col-6">
              <label for="type">Media type filter:</label>
              <select id="type" multiple="multiple">
              </select>

              <label for="properties.writable">Writable:</label>
              <input type="checkbox" id="properties.writable" />

              <label for="properties.withoutLocations">Zonder locaties:</label>
              <input type="checkbox" id="properties.withoutLocations" />

              <label for="avType">AVType:</label>
              <select id="avType">
                <option value="">ANY</option>
                <option value="AUDIO">Audio</option>
                <option value="VIDEO">Video</option>
              </select>

              <label for="broadcaster">Omroep:</label>
              <select id="broadcaster" multiple>
                <option value="">ANY</option>
                <option value="BNVA">BNNVARA</option>
                <option value="VPRO">VPRO</option>
                <option value="EO">EO</option>
              </select>

            </div>
            <div class="col-6">
              <label for="return">Return data:</label>
              <select id="return">
                <option value="">MID (default)</option>
                <option value="mid">MID</option>
                <option value="title">Title</option>
                <option value="data">All (JSON) data</option>
              </select>
            </div>
          </div>

          <div class="row">
            <button id="select" class="btn-rect">Select</button>
          </div>

          <div class="row">
            <label for="result">Result:</label>
            <input id="result" type="text"/>
            <label for="value">Raw result</label>
            <textarea id="value"> </textarea>
          </div>

        </div>

      </div>
    </div>


    <script>
      nl_vpro_media_CMSSelector.getMediaTypes(document.getElementById('type'));
      nl_vpro_media_CMSSelector.getBroadcasters().then(function (broadcasters) {
        console.log(broadcasters);
      }, function() {
        console.log('error');
      });

      document.getElementById('select').onclick = function () {
        const types = this.getMultiple('type');
        const broadcasters = this.getMultiple('broadcaster');
        this.select(function (value) {
          let result = value;
          if (typeof result === "object") {
            result = result.mid + ":" + result.title;
          }
          document.getElementById('result').value = result;
          document.getElementById('value').value = JSON.stringify(value);
                }, {
          mediaType: types.join(),
          "properties.writable": document.getElementById('properties.writable').checked,
          "properties.withoutLocations": document.getElementById('properties.withoutLocations').checked,
          avType: document.getElementById('avType').value,
          broadcaster: broadcasters.join(),
          returnValue: document.getElementById('return').value
                }
        );
      }.bind(nl_vpro_media_CMSSelector);
    </script>

  </body>
</html>
